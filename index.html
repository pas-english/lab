startBtn.onclick = async () => {
        const nameInput = document.getElementById('studentName');
        const status = document.getElementById('status');
        
        // ğŸŒŸ æº«é¦¨æé†’é‚è¼¯
        if (!nameInput.value.trim()) { 
            status.style.background = "#fff5f5";
            status.style.color = "#e53e3e";
            status.innerText = "ğŸ’¡ è€å¸«æé†’ï¼šè¦å…ˆè¼¸å…¥å§“åæ‰èƒ½é–‹å§‹å–”ï¼";
            nameInput.style.borderColor = "#e53e3e";
            nameInput.focus();
            return; 
        }

        try {
            // å›å¾©æ­£å¸¸çš„ç‹€æ…‹é¡è‰²
            status.style.background = "#edf2f7";
            status.style.color = "#2d3748";
            
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
            dest = audioContext.createMediaStreamDestination();
            const micStream = await navigator.mediaDevices.getUserMedia({ audio: true });
            micSource = audioContext.createMediaStreamSource(micStream);
            micSource.connect(dest);
            teacherSource = audioContext.createMediaElementSource(teacherAudio);
            teacherSource.connect(dest);
            teacherSource.connect(audioContext.destination);

            recorder = new MediaRecorder(dest.stream);
            recorder.ondataavailable = e => chunks.push(e.data);
            recorder.onstop = () => {
                const blob = new Blob(chunks, { type: 'audio/webm' });
                audioPlayer.src = URL.createObjectURL(blob);
                audioPlayer.style.display = 'block';
                uploadBtn.style.display = 'block';
                status.innerText = "ğŸ‰ å¤ªæ£’äº†ï¼éŒ„éŸ³å®Œæˆï¼Œåˆ¥å¿˜äº†æŒ‰ Send ä¸Šå‚³å–”ã€‚";
            };

            chunks = [];
            teacherAudio.play();
            recorder.start();
            startBtn.disabled = true;
            stopBtn.disabled = false;
            status.innerText = "ğŸ”´ æ­£åœ¨éŒ„éŸ³ä¸­ï¼ŒåŠ æ²¹ï¼è·Ÿè‘—è€å¸«è®€...";
        } catch (err) { 
            status.innerText = "âŒ ç³Ÿç³•ï¼éº¥å…‹é¢¨æ²’é–‹å•Ÿï¼Œè«‹é»æ“Šç¶²å€æ—çš„é–é ­å…è¨±ã€‚";
        }
    };
